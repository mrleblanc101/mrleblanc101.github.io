export default (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH){return {data:{surround:[{_path:"\u002Fblog\u002F2023-01-01-mots-de-bienvenue",title:"Bienvenue sur mon site web !"},null],"content-query-tKGWIcYRfz":{_path:"\u002Fblog\u002F2023-01-17-momentjs-avec-nuxt3",_dir:"blog",_draft:A,_partial:A,_locale:"en",_empty:A,title:"Utiliser moment.js avec Nuxt 3",description:"Vous avez peut-Ãªtre remarquer que le module @nuxtjs\u002Fmoment n'est pas capatible avec Nuxt 3.",excerpt:{type:H,children:[{type:a,tag:e,props:{},children:[{type:b,value:I},{type:a,tag:i,props:{href:J,rel:[j]},children:[{type:b,value:q}]},{type:b,value:K}]},{type:a,tag:e,props:{},children:[{type:b,value:L},{type:a,tag:i,props:{href:M,rel:[j]},children:[{type:b,value:r}]},{type:b,value:N}]},{type:a,tag:e,props:{},children:[{type:b,value:O},{type:a,tag:l,props:{},children:[{type:b,value:r}]},{type:b,value:P}]},{type:a,tag:e,props:{},children:[{type:b,value:Q},{type:a,tag:l,props:{},children:[{type:b,value:q}]},{type:b,value:R},{type:a,tag:l,props:{},children:[{type:b,value:S}]},{type:b,value:T}]},{type:a,tag:e,props:{},children:[{type:b,value:U},{type:a,tag:i,props:{href:V,rel:[j]},children:[{type:b,value:W}]},{type:b,value:X}]},{type:a,tag:e,props:{},children:[{type:b,value:Y},{type:a,tag:i,props:{href:Z,rel:[j]},children:[{type:b,value:_}]},{type:b,value:$}]},{type:a,tag:m,props:{code:B,filename:aa,highlights:[s],language:ab},children:[{type:a,tag:t,props:{},children:[{type:a,tag:m,props:{__ignoreMap:o},children:[{type:b,value:B}]}]}]},{type:a,tag:e,props:{},children:[{type:b,value:ac}]},{type:a,tag:ad,props:{},children:[{type:a,tag:e,props:{},children:[{type:b,value:ae}]}]},{type:a,tag:e,props:{},children:[{type:b,value:af},{type:a,tag:i,props:{href:ag,rel:[j]},children:[{type:b,value:u}]},{type:b,value:ah}]},{type:a,tag:e,props:{},children:[{type:b,value:ai}]},{type:a,tag:m,props:{code:C,language:aj},children:[{type:a,tag:t,props:{},children:[{type:a,tag:m,props:{__ignoreMap:o},children:[{type:b,value:C}]}]}]},{type:a,tag:e,props:{},children:[{type:b,value:ak}]},{type:a,tag:e,props:{},children:[{type:b,value:al}]},{type:a,tag:e,props:{},children:[{type:b,value:am},{type:a,tag:i,props:{href:an,rel:[j]},children:[{type:b,value:ao}]},{type:b,value:ap},{type:a,tag:l,props:{},children:[{type:b,value:aq}]},{type:b,value:ar}]},{type:a,tag:e,props:{},children:[{type:b,value:as},{type:a,tag:i,props:{href:at,rel:[j]},children:[{type:b,value:au}]},{type:b,value:av},{type:a,tag:i,props:{href:aw,rel:[j]},children:[{type:b,value:u}]},{type:b,value:ax}]}]},createdAt:"2023-01-17T00:00:00.000Z",readingTime:{text:"3 min read",minutes:2.25,time:135000,words:450},body:{type:H,children:[{type:a,tag:e,props:{},children:[{type:b,value:I},{type:a,tag:i,props:{href:J,rel:[j]},children:[{type:b,value:q}]},{type:b,value:K}]},{type:a,tag:e,props:{},children:[{type:b,value:L},{type:a,tag:i,props:{href:M,rel:[j]},children:[{type:b,value:r}]},{type:b,value:N}]},{type:a,tag:e,props:{},children:[{type:b,value:O},{type:a,tag:l,props:{},children:[{type:b,value:r}]},{type:b,value:P}]},{type:a,tag:e,props:{},children:[{type:b,value:Q},{type:a,tag:l,props:{},children:[{type:b,value:q}]},{type:b,value:R},{type:a,tag:l,props:{},children:[{type:b,value:S}]},{type:b,value:T}]},{type:a,tag:e,props:{},children:[{type:b,value:U},{type:a,tag:i,props:{href:V,rel:[j]},children:[{type:b,value:W}]},{type:b,value:X}]},{type:a,tag:e,props:{},children:[{type:b,value:Y},{type:a,tag:i,props:{href:Z,rel:[j]},children:[{type:b,value:_}]},{type:b,value:$}]},{type:a,tag:m,props:{code:B,filename:aa,highlights:[s],language:ab},children:[{type:a,tag:t,props:{},children:[{type:a,tag:m,props:{__ignoreMap:o},children:[{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:g},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:ay}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:E},children:[{type:b,value:"'moment'"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:w}]}]},{type:a,tag:c,props:{class:"line highlight"},children:[{type:a,tag:c,props:{class:g},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:E},children:[{type:b,value:"'moment\u002Flocale\u002Ffr-ca'"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:w}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:g},children:[{type:b,value:D}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:"type"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:" { "}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:az}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:" } "}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:ay}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:E},children:[{type:b,value:"'#app'"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:w}]}]},{type:a,tag:c,props:{class:f},children:[]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:g},children:[{type:b,value:"export"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:"default"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:"defineNuxtPlugin"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"((nuxtApp) "}]},{type:a,tag:c,props:{class:F},children:[{type:b,value:aA}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:F},children:[{type:b,value:"const"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:p}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aB}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:aC}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:n}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:aD}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:n}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:p}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:n}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:"value"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:w}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:n}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:p}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:aE}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:p}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:aF}]}]},{type:a,tag:c,props:{class:f},children:[]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:aC}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:n}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:aD}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:n}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:"onBeforeLanguageSwitch"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aB}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:" ("}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        oldLocale"}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aG}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:z}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        newLocale"}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aG}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:z}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        isInitialSetup"}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:"boolean"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:z}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        nuxtApp"}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:k}]},{type:a,tag:c,props:{class:"ct-ad8eda"},children:[{type:b,value:az}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"    ) "}]},{type:a,tag:c,props:{class:F},children:[{type:b,value:aA}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        "}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:n}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:p}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:aE}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:"newLocale"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:aF}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:aH}]}]},{type:a,tag:c,props:{class:f},children:[]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:x}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:"return"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:G}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        provide: {"}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"            "}]},{type:a,tag:c,props:{class:h},children:[{type:b,value:v}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:z}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        },"}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:aH}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"});"}]}]}]}]}]},{type:a,tag:e,props:{},children:[{type:b,value:ac}]},{type:a,tag:ad,props:{},children:[{type:a,tag:e,props:{},children:[{type:b,value:ae}]}]},{type:a,tag:e,props:{},children:[{type:b,value:af},{type:a,tag:i,props:{href:ag,rel:[j]},children:[{type:b,value:u}]},{type:b,value:ah}]},{type:a,tag:e,props:{},children:[{type:b,value:ai}]},{type:a,tag:m,props:{code:C,language:aj},children:[{type:a,tag:t,props:{},children:[{type:a,tag:m,props:{__ignoreMap:o},children:[{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:"ct-7acfc1"},children:[{type:b,value:"- import 'moment\u002Flocale\u002Ffr-ca';"}]}]},{type:a,tag:c,props:{class:f},children:[]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:"ct-185ae9"},children:[{type:b,value:"+ import 'moment\u002Fdist\u002Flocale\u002Ffr-ca';"}]}]}]}]}]},{type:a,tag:e,props:{},children:[{type:b,value:ak}]},{type:a,tag:e,props:{},children:[{type:b,value:al}]},{type:a,tag:e,props:{},children:[{type:b,value:am},{type:a,tag:i,props:{href:an,rel:[j]},children:[{type:b,value:ao}]},{type:b,value:ap},{type:a,tag:l,props:{},children:[{type:b,value:aq}]},{type:b,value:ar}]},{type:a,tag:e,props:{},children:[{type:b,value:as},{type:a,tag:i,props:{href:at,rel:[j]},children:[{type:b,value:au}]},{type:b,value:av},{type:a,tag:i,props:{href:aw,rel:[j]},children:[{type:b,value:u}]},{type:b,value:ax}]},{type:a,tag:"style",children:[{type:b,value:".ct-185ae9{color:#219186}\n.ct-7acfc1{color:#DC322F}\n.ct-ad8eda{color:#268BD2}\n.ct-083dc6{color:#073642}\n.ct-9ae664{color:#2AA198}\n.ct-82aea0{color:#268BD2}\n.ct-29651d{color:#657B83}\n.ct-9c4aea{color:#859900}\n.dark .ct-9c4aea{color:#859900}\n.dark .ct-29651d{color:#93A1A1}\n.dark .ct-82aea0{color:#268BD2}\n.dark .ct-9ae664{color:#2AA198}\n.dark .ct-083dc6{color:#93A1A1}\n.dark .ct-ad8eda{color:#CB4B16}\n.dark .ct-7acfc1{color:#DC322F}\n.dark .ct-185ae9{color:#219186}"}]}],toc:{title:o,searchDepth:s,depth:s,links:[]}},_type:"markdown",_id:"content:blog:2023-01-17-momentjs-avec-nuxt3.md",_source:"content",_file:"blog\u002F2023-01-17-momentjs-avec-nuxt3.md",_extension:"md"}},prerenderedAt:1674498820951}}("element","text","span","ct-29651d","p","line","ct-9c4aea","ct-82aea0","a","nofollow"," ","code-inline","code",".","","locale","@nuxtjs\u002Fmoment","moment.js",2,"pre","issue","moment",";","    ",":",",",false,"import moment from 'moment';\nimport 'moment\u002Flocale\u002Ffr-ca';\nimport type { NuxtApp } from '#app';\n\nexport default defineNuxtPlugin((nuxtApp) =\u003E {\n    const locale = nuxtApp.$i18n.locale.value;\n    moment.locale(locale);\n\n    nuxtApp.$i18n.onBeforeLanguageSwitch = (\n        oldLocale: string,\n        newLocale: string,\n        isInitialSetup: boolean,\n        nuxtApp: NuxtApp\n    ) =\u003E {\n        moment.locale(newLocale);\n    };\n\n    return {\n        provide: {\n            moment,\n        },\n    };\n});\n","- import 'moment\u002Flocale\u002Ffr-ca';\n\n+ import 'moment\u002Fdist\u002Flocale\u002Ffr-ca';\n","import","ct-9ae664","ct-083dc6"," {","root","Vous avez peut-Ãªtre remarquer que le module ","https:\u002F\u002Fgithub.com\u002Fnuxt-community\u002Fmoment-module"," n'est pas capatible avec Nuxt 3.","Vous vous demandez sans doute pourquoi as-t-on besoin d'un module pour utiliser ","https:\u002F\u002Fmomentjs.com\u002F"," dans Nuxt ?","Dans Nuxt 2, lorsque vous utilisez ",", Webpack importe toutes les locales par dÃ©faut. Cela Ã©quivaut Ã  plus d'une centaine de locales qui sont importÃ©es alors que vous n'avez probablement besoin que d'une ou deux d'entre elles.","VoilÃ  ou entre en jeu ","; celui-ci se charge de supprimer les locales inutiles en utilisant ","moment-locales-webpack-plugin"," afin de rÃ©duire la taille du bundle de votre application.","Si vous avez suivi l'actualitÃ©, vous savez peut-Ãªtre que Nuxt 3 utilise maintenant ","https:\u002F\u002Fvitejs.dev\u002F","Vite.js"," au lieu de Webpack afin de bundler votre application. Il n'est donc plus nÃ©cessaire de suppimer les locales inutilisÃ©es du bundle puisque Vite.js s'en charge dÃ©jÃ  grÃ¢ce Ã  son meilleur support du tree-shaking.","Voici comment crÃ©er votre propre plugin pour utiliser moment.js directement dans une application multilingue utilisant ","https:\u002F\u002Fv8.i18n.nuxtjs.org\u002F","@nuxtjs\u002Fi18n"," et TypeScript dans Nuxt 3.","plugins\u002Fmoment.ts","js","Ã premiÃ¨re vue, ce code d'importation (ligne 1 et 2) qui provient de la documentation officiel de moment.js devrait fonctionner.\nPar contre, si vous avez utiliser ce code directement, vous aurez remarquer cette erreur lors de la compilation:","blockquote","Uncaught TypeError: Cannot read properties of undefined (reading 'defineLocale')","Il s'agit d'une erreur dÃ©routante que je pris bien du temps Ã  corriger, mais grÃ¢ce Ã  cette ","https:\u002F\u002Fgithub.com\u002Fmoment\u002Fmoment\u002Fissues\u002F5926#issuecomment-1056785251"," Github, j'ai finalement rÃ©ussi Ã  rÃ©glÃ© le problÃ¨me et complÃ©tÃ© la migration vers Nuxt 3 de mon application.","Avec Vite.js, il faut simplement changer l'import des locales comme ceci:","diff","Malheureusement, ne vous attendez pas Ã  une correction de la part de moment.js puisque le projet est en mode maintenance et ne recevera de mise Ã  jour que si une faille de sÃ©curitÃ© majeure est dÃ©couverte.","Vous pouvez migrer vers une alternatives plus modernes Ã  moment.js, mais dans mon cas, je devais migrÃ© une code base utilisant largement moment.js en Nuxt 3.","J'ai bien tentÃ© de migrer vers ","https:\u002F\u002Fday.js.org\u002F","Day.js"," a une API rÃ©trocompatible et Ã  l'avantage d'une approche modulaire et un code plus moderne lui permettant d'avoir un poid rÃ©duit (7kb vs 61kb) en prenant avantage des derniÃ¨res fonctionnalitÃ©s d'internationalisation d'EcmaScript, mais j'ai fait faÃ§e Ã  une fonctionalitÃ© manquante en lien avec le parsing des heures (Ex. ","10:00:00",") sans date d'associÃ©es.","Heureusement, je pourrai peut-Ãªtre faire la migration Ã©ventuellement puisqu'une ","https:\u002F\u002Fgithub.com\u002Fiamkun\u002Fdayjs\u002Fpull\u002F2197","pull request"," afin d'apporter cette fonctionnalitÃ© Ã  Day.js a Ã©tÃ© ouverte aprÃ¨s que j'aie ouvert l'","https:\u002F\u002Fgithub.com\u002Fiamkun\u002Fdayjs\u002Fissues\u002F2179"," sur Github afin de reportÃ©e ce manquemant par rapport Ã  moment.js.","from","NuxtApp","=\u003E","=","nuxtApp","$i18n","(",");","string","    };"))