export default (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO){return {data:{projets:[{_path:"\u002Fblog\u002F2023-01-01-mots-de-bienvenue",_dir:G,_draft:n,_partial:n,_locale:H,_empty:n,title:"Bienvenue sur mon site web !",description:z,excerpt:{type:p,children:[{type:a,tag:e,props:{},children:[{type:b,value:z}]},{type:a,tag:e,props:{},children:[{type:b,value:I}]},{type:a,tag:e,props:{},children:[{type:b,value:J},{type:a,tag:k,props:{},children:[{type:b,value:K}]},{type:b,value:L},{type:a,tag:k,props:{},children:[{type:b,value:M}]},{type:b,value:N}]},{type:a,tag:e,props:{},children:[{type:b,value:O}]},{type:a,tag:e,props:{},children:[{type:b,value:P}]}]},createdAt:"2023-01-01T00:00:00.000Z",readingTime:{text:"1 min read",minutes:.43,time:25800,words:86},body:{type:p,children:[{type:a,tag:e,props:{},children:[{type:b,value:z}]},{type:a,tag:e,props:{},children:[{type:b,value:I}]},{type:a,tag:e,props:{},children:[{type:b,value:J},{type:a,tag:k,props:{},children:[{type:b,value:K}]},{type:b,value:L},{type:a,tag:k,props:{},children:[{type:b,value:M}]},{type:b,value:N}]},{type:a,tag:e,props:{},children:[{type:b,value:O}]},{type:a,tag:e,props:{},children:[{type:b,value:P}]}],toc:{title:o,searchDepth:q,depth:q,links:[]}},_type:Q,_id:"content:blog:2023-01-01-mots-de-bienvenue.md",_source:R,_file:"blog\u002F2023-01-01-mots-de-bienvenue.md",_extension:S},null],"content-query-tKGWIcYRfz":{_path:"\u002Fblog\u002F2023-01-17-momentjs-avec-nuxt3",_dir:G,_draft:n,_partial:n,_locale:H,_empty:n,title:"Utiliser moment.js avec Nuxt 3",description:"Vous avez peut-être remarquer que le module @nuxtjs\u002Fmoment n'est pas capatible avec Nuxt 3.",excerpt:{type:p,children:[{type:a,tag:e,props:{},children:[{type:b,value:T},{type:a,tag:h,props:{href:U,rel:[i]},children:[{type:b,value:r}]},{type:b,value:V}]},{type:a,tag:e,props:{},children:[{type:b,value:W},{type:a,tag:h,props:{href:X,rel:[i]},children:[{type:b,value:s}]},{type:b,value:Y}]},{type:a,tag:e,props:{},children:[{type:b,value:Z},{type:a,tag:k,props:{},children:[{type:b,value:s}]},{type:b,value:_}]},{type:a,tag:e,props:{},children:[{type:b,value:$},{type:a,tag:k,props:{},children:[{type:b,value:r}]},{type:b,value:aa},{type:a,tag:k,props:{},children:[{type:b,value:ab}]},{type:b,value:ac}]},{type:a,tag:e,props:{},children:[{type:b,value:ad},{type:a,tag:h,props:{href:ae,rel:[i]},children:[{type:b,value:af}]},{type:b,value:ag}]},{type:a,tag:e,props:{},children:[{type:b,value:ah},{type:a,tag:h,props:{href:ai,rel:[i]},children:[{type:b,value:aj}]},{type:b,value:ak}]},{type:a,tag:m,props:{code:A,language:al},children:[{type:a,tag:t,props:{},children:[{type:a,tag:m,props:{__ignoreMap:o},children:[{type:b,value:A}]}]}]},{type:a,tag:e,props:{},children:[{type:b,value:am}]},{type:a,tag:an,props:{},children:[{type:a,tag:e,props:{},children:[{type:b,value:ao}]}]},{type:a,tag:e,props:{},children:[{type:b,value:ap},{type:a,tag:h,props:{href:aq,rel:[i]},children:[{type:b,value:u}]},{type:b,value:ar}]},{type:a,tag:e,props:{},children:[{type:b,value:as}]},{type:a,tag:m,props:{code:B,language:at},children:[{type:a,tag:t,props:{},children:[{type:a,tag:m,props:{__ignoreMap:o},children:[{type:b,value:B}]}]}]},{type:a,tag:e,props:{},children:[{type:b,value:au}]},{type:a,tag:e,props:{},children:[{type:b,value:av}]},{type:a,tag:e,props:{},children:[{type:b,value:aw},{type:a,tag:h,props:{href:ax,rel:[i]},children:[{type:b,value:ay}]},{type:b,value:az},{type:a,tag:k,props:{},children:[{type:b,value:aA}]},{type:b,value:aB}]},{type:a,tag:e,props:{},children:[{type:b,value:aC},{type:a,tag:h,props:{href:aD,rel:[i]},children:[{type:b,value:aE}]},{type:b,value:aF},{type:a,tag:h,props:{href:aG,rel:[i]},children:[{type:b,value:u}]},{type:b,value:aH}]}]},createdAt:"2023-01-17T00:00:00.000Z",readingTime:{text:"3 min read",minutes:2.24,time:134400,words:448},body:{type:p,children:[{type:a,tag:e,props:{},children:[{type:b,value:T},{type:a,tag:h,props:{href:U,rel:[i]},children:[{type:b,value:r}]},{type:b,value:V}]},{type:a,tag:e,props:{},children:[{type:b,value:W},{type:a,tag:h,props:{href:X,rel:[i]},children:[{type:b,value:s}]},{type:b,value:Y}]},{type:a,tag:e,props:{},children:[{type:b,value:Z},{type:a,tag:k,props:{},children:[{type:b,value:s}]},{type:b,value:_}]},{type:a,tag:e,props:{},children:[{type:b,value:$},{type:a,tag:k,props:{},children:[{type:b,value:r}]},{type:b,value:aa},{type:a,tag:k,props:{},children:[{type:b,value:ab}]},{type:b,value:ac}]},{type:a,tag:e,props:{},children:[{type:b,value:ad},{type:a,tag:h,props:{href:ae,rel:[i]},children:[{type:b,value:af}]},{type:b,value:ag}]},{type:a,tag:e,props:{},children:[{type:b,value:ah},{type:a,tag:h,props:{href:ai,rel:[i]},children:[{type:b,value:aj}]},{type:b,value:ak}]},{type:a,tag:m,props:{code:A,language:al},children:[{type:a,tag:t,props:{},children:[{type:a,tag:m,props:{__ignoreMap:o},children:[{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:g},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:" moment "}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aI}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:D},children:[{type:b,value:"'moment'"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:v}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:g},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:D},children:[{type:b,value:"'moment\u002Flocale\u002Ffr-ca'"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:v}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:g},children:[{type:b,value:C}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:"type"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:" { NuxtApp } "}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aI}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:D},children:[{type:b,value:"'#app'"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:v}]}]},{type:a,tag:c,props:{class:f},children:[]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:g},children:[{type:b,value:"export"}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:"default"}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:w},children:[{type:b,value:"defineNuxtPlugin"}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:"((nuxtApp) "}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aJ}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"{"}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:aK}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:"const"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:x},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aL}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:" nuxtApp.$i18n.locale.value;"}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"    moment."}]},{type:a,tag:c,props:{class:w},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"(locale);"}]}]},{type:a,tag:c,props:{class:f},children:[]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"    nuxtApp.$i18n."}]},{type:a,tag:c,props:{class:w},children:[{type:b,value:"onBeforeLanguageSwitch"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aL}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:" ("}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:"oldLocale"}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:x},children:[{type:b,value:aM}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:"newLocale"}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:x},children:[{type:b,value:aM}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:"isInitialSetup"}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:x},children:[{type:b,value:"boolean"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:F}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:"nuxtApp"}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:y}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:j}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:"NuxtApp"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:") "}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:aJ}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:aN}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        moment."}]},{type:a,tag:c,props:{class:w},children:[{type:b,value:E}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:"(newLocale);"}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:aO}]}]},{type:a,tag:c,props:{class:f},children:[]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:aK}]},{type:a,tag:c,props:{class:g},children:[{type:b,value:"return"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:aN}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        provide: {"}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"            moment,"}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"        },"}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:aO}]}]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:d},children:[{type:b,value:"}"}]},{type:a,tag:c,props:{class:l},children:[{type:b,value:")"}]},{type:a,tag:c,props:{class:d},children:[{type:b,value:v}]}]}]}]}]},{type:a,tag:e,props:{},children:[{type:b,value:am}]},{type:a,tag:an,props:{},children:[{type:a,tag:e,props:{},children:[{type:b,value:ao}]}]},{type:a,tag:e,props:{},children:[{type:b,value:ap},{type:a,tag:h,props:{href:aq,rel:[i]},children:[{type:b,value:u}]},{type:b,value:ar}]},{type:a,tag:e,props:{},children:[{type:b,value:as}]},{type:a,tag:m,props:{code:B,language:at},children:[{type:a,tag:t,props:{},children:[{type:a,tag:m,props:{__ignoreMap:o},children:[{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:"ct-69d144"},children:[{type:b,value:"- import 'moment\u002Flocale\u002Ffr-ca';"}]}]},{type:a,tag:c,props:{class:f},children:[]},{type:a,tag:c,props:{class:f},children:[{type:a,tag:c,props:{class:"ct-3d81e5"},children:[{type:b,value:"+ import 'moment\u002Fdist\u002Flocale\u002Ffr-ca';"}]}]}]}]}]},{type:a,tag:e,props:{},children:[{type:b,value:au}]},{type:a,tag:e,props:{},children:[{type:b,value:av}]},{type:a,tag:e,props:{},children:[{type:b,value:aw},{type:a,tag:h,props:{href:ax,rel:[i]},children:[{type:b,value:ay}]},{type:b,value:az},{type:a,tag:k,props:{},children:[{type:b,value:aA}]},{type:b,value:aB}]},{type:a,tag:e,props:{},children:[{type:b,value:aC},{type:a,tag:h,props:{href:aD,rel:[i]},children:[{type:b,value:aE}]},{type:b,value:aF},{type:a,tag:h,props:{href:aG,rel:[i]},children:[{type:b,value:u}]},{type:b,value:aH}]},{type:a,tag:"style",children:[{type:b,value:".ct-3d81e5{color:#116329}\n.ct-69d144{color:#82071E}\n.ct-934b96{color:#0550AE}\n.ct-e28d84{color:#8250DF}\n.ct-33f4ce{color:#953800}\n.ct-bc7183{color:#0A3069}\n.ct-aec7c9{color:#24292F}\n.ct-ff52ad{color:#CF222E}\n.dark .ct-ff52ad{color:#FF7B72}\n.dark .ct-aec7c9{color:#C9D1D9}\n.dark .ct-bc7183{color:#A5D6FF}\n.dark .ct-33f4ce{color:#FFA657}\n.dark .ct-e28d84{color:#D2A8FF}\n.dark .ct-934b96{color:#79C0FF}\n.dark .ct-69d144{color:#FFA198}\n.dark .ct-3d81e5{color:#7EE787}"}]}],toc:{title:o,searchDepth:q,depth:q,links:[]}},_type:Q,_id:"content:blog:2023-01-17-momentjs-avec-nuxt3.md",_source:R,_file:"blog\u002F2023-01-17-momentjs-avec-nuxt3.md",_extension:S}},prerenderedAt:1674366355793}}("element","text","span","ct-aec7c9","p","line","ct-ff52ad","a","nofollow"," ","code-inline","ct-33f4ce","code",false,"","root",2,"@nuxtjs\u002Fmoment","moment.js","pre","issue",";","ct-e28d84","ct-934b96",":","Nouvelle année, nouvelle résolution !","import moment from 'moment';\nimport 'moment\u002Flocale\u002Ffr-ca';\nimport type { NuxtApp } from '#app';\n\nexport default defineNuxtPlugin((nuxtApp) =\u003E {\n    const locale = nuxtApp.$i18n.locale.value;\n    moment.locale(locale);\n\n    nuxtApp.$i18n.onBeforeLanguageSwitch = (oldLocale: string, newLocale: string, isInitialSetup: boolean, nuxtApp: NuxtApp) =\u003E {\n        moment.locale(newLocale);\n    };\n\n    return {\n        provide: {\n            moment,\n        },\n    };\n});\n","- import 'moment\u002Flocale\u002Ffr-ca';\n\n+ import 'moment\u002Fdist\u002Flocale\u002Ffr-ca';\n","import","ct-bc7183","locale",", ","blog","en","Après trop de procrastination, j'ai enfin décidé qu'il était temps de refaire mon site personnel de zéro.","En tant qu'à y être, de tester le nouveau ","nuxt@^3.0.0"," qui vient tout juste d'être lancé en version stable ainsi que ","nuxt\u002Fcontent@^2.0.0"," pour générer un blog de manière statique afin de hoster mon site gratuitement sur Github Pages.","Sur ce blog, vous découvrirez mes expérimentations ainsi que des trucs et astuce sur l'écosystème Vue.js et Nuxt.js","J'espère vous être utile ! N'hésitez pas à poser des questions dans les commentaires.","markdown","content","md","Vous avez peut-être remarquer que le module ","https:\u002F\u002Fgithub.com\u002Fnuxt-community\u002Fmoment-module"," n'est pas capatible avec Nuxt 3.","Vous vous demandez sans doute pourquoi as-t-on besoin d'un module pour utiliser ","https:\u002F\u002Fmomentjs.com\u002F"," dans Nuxt ?","Dans Nuxt 2, lorsque vous utilisez ",", Webpack importe toutes les locales par défaut. Cela équivaut à plus d'une centaine de locales qui sont importées alors que vous n'avez probablement besoin que d'une ou deux d'entre elles.","Voilà ou entre en jeu ","; celui-ci se charge de supprimer les locales inutiles en utilisant ","moment-locales-webpack-plugin"," afin de réduire la taille du bundle de votre application.","Si vous avez suivi l'actualité, vous savez peut-être que Nuxt 3 utilise maintenant ","https:\u002F\u002Fvitejs.dev\u002F","Vite.js"," au lieu de Webpack afin de bundler votre application. Il n'est donc plus nécessaire de suppimer les locales inutilisées du bundle puisque Vite.js s'en charge déjà grâce à son meilleur support du tree-shaking.","Voici comment créer votre propre plugin pour utiliser moment.js directement dans une application multilingue utilisant ","https:\u002F\u002Fv8.i18n.nuxtjs.org\u002F","@nuxtjs\u002Fi18n"," et TypeScript dans Nuxt 3.","ts","À première vue, ce code d'importation (ligne 1 et 2) qui provient de la documentation officiel de moment.js devrait fonctionner.\nPar contre, si vous avez utiliser ce code directement, vous aurez remarquer cette erreur lors de la compilation:","blockquote","Uncaught TypeError: Cannot read properties of undefined (reading 'defineLocale')","Il s'agit d'une erreur déroutante que je pris bien du temps à corriger, mais grâce à cette ","https:\u002F\u002Fgithub.com\u002Fmoment\u002Fmoment\u002Fissues\u002F5926#issuecomment-1056785251"," Github, j'ai finalement réussi à réglé le problème et complété la migration vers Nuxt 3 de mon application.","Avec Vite.js, il faut simplement changer l'import des locales comme ceci:","diff","Malheureusement, ne vous attendez pas à une correction de la part de moment.js puisque le projet est en mode maintenance et ne recevera de mise à jour que si une faille de sécurité majeure est découverte.","Vous pouvez migrer vers une alternatives plus modernes à moment.js, mais dans mon cas, je devais migré une code base utilisant largement moment.js en Nuxt 3.","J'ai bien tenté de migrer vers ","https:\u002F\u002Fday.js.org\u002F","Day.js"," a une API rétrocompatible et à l'avantage d'une approche modulaire et un code plus moderne lui permettant d'avoir un poid réduit (7kb vs 61kb) en prenant avantage des dernières fonctionnalités d'internationalisation d'EcmaScript, mais j'ai fait façe à une fonctionalité manquante en lien avec le parsing des heures (Ex. ","10:00:00",") sans date d'associées.","Heureusement, je pourrai peut-être faire la migration éventuellement puisqu'une ","https:\u002F\u002Fgithub.com\u002Fiamkun\u002Fdayjs\u002Fpull\u002F2197","pull request"," afin d'apporter cette fonctionnalité à Day.js a été ouverte après que j'aie ouvert '","https:\u002F\u002Fgithub.com\u002Fiamkun\u002Fdayjs\u002Fissues\u002F2179"," sur Github afin de reportée ce manquemant par rapport à moment.js.","from","=\u003E","    ","=","string"," {","    };"))